# Benchmark the computation time of the five different computational backends on different hardware architectures

- `run_benchmarks.py`: Writes the job script to run the model either on a computing cluster via SLURM or on a local computer (e.g. notebook).
- `job.sh`: Job script generated by `run_benchmarks.py`
- `get_timing.py`: Extract computation times from log-files of RoGeR.
- `input`: Contains the input data for the models to benchmark
- `var_proc`: Contains files with computation time for varying number of CPU cores
- `var_size`: Contains files with computation time for varying number of grid cells
- `benchmark_base.py`: Extended command line interface (CLI) for benchmarking. CLI is wrapped around the model setups.

Considered hardware architectures:
- `binac`: (Standard and GPU)[https://wiki.bwhpc.de/e/BinAC/Hardware_and_Architecture]
- `bwunicluster2`: (Compute nodes "HPC" and IceLake + GPU x4)[https://wiki.bwhpc.de/e/BwUniCluster2.0/Hardware_and_Architecture]
- `macbookpro15_2012`: (MacBook Pro (15-inch, Mid 2012))[https://support.apple.com/kb/SP694?viewlocale=en_GB&locale=de_DE]
- `macbookpro14_2023`: (MacBook Pro (14-inch, 2023))[https://support.apple.com/kb/SP889?viewlocale=en_GB&locale=de_DE]

Considered models for the benchmarking:
- `SVAT_benchmark.py`: SVAT-model with free drainage and no lateral flow
- `oneD_benchmark.py`: 1D-model with free drainage
- `SVATOXYGEN18_benchmark.py`: SVAT-model for oxygen18 transport using fluxes and soil water content as input

For the benchmarking experiments, the model parameters are repeated depending on the size of the experiment (i.e. number of grid cells).

## Benchmark of the SVAT model

Workflow on a local computer:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_notebook_var_proc_svat.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_notebook_var_size_svat.sh`

Workflow on a computing cluster:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_cluster_var_proc_svat.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_cluster_var_size_svat.sh`
3. Extract the computation times using `HABENCH=bwunicluster2 get_timing_for_svat.sh`

## Benchmark of the SVAT model for oxygen18 transport

Workflow on a local computer:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_notebook_var_proc_svat_oxygen18.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_notebook_var_size_svat_oxygen18.sh`

Workflow on a computing cluster:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_cluster_var_proc_svat_oxygen18.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_cluster_var_size_svat_oxygen18.sh`
3. Extract the computation times using `HABENCH=bwunicluster2 get_timing_for_svat_oxygen18.sh`

## Benchmark of the 1D model

Workflow on a local computer:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_notebook_var_proc_oneD.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_notebook_var_size_oneD.sh`

Workflow on a computing cluster:
1. Run the benchmark simulations for varying number of CPU cores using `submit_benchmarks_to_cluster_var_proc_oneD.sh`
2. Run the benchmark simulations for varying number of grid cells cores using `submit_benchmarks_to_cluster_var_size_oneD.sh`
3. Extract the computation times using `HABENCH=bwunicluster2 get_timing_for_oneD.sh`
